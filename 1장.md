# 1장 코틀린이란 무엇이며, 왜 필요한가?

### 코틀린(kotlin)이란?

- 자바 플랫폼에서 돌아가는 새로운 프로그래밍 언어
- 간결하고 실용적
- 자바 코드와의 상호운용성을 중시
- 대표적으로 서버 개발, 안드로이드 앱 개발 분야에서 쓸 수 있음
- 기존 자바 라이브러리나 프레임워크와 함께 잘 작동



## 1.1 코틀린 맛보기

```kotlin
data class Person(val name: String,	// '데이터' 클래스
                  val age: Int? = null)	// 널이 될 수 있는 타입(Int?)과 파리미터 디폴트 값
fun main(args: Array<String>) {	// 최상위 함수
  val persons = listOf(Person("영희"), 
                       Person("철수", age = 29))	// 이름 붙은 파라미터
  val oldest = persons.maxBy { it.age ?: 0 }	// 람다 식과 엘비스 연산자
  println("나이가 가장 많은 사람: $oldest")	// 문자열 xpavmfflt
}

// 결과: 나이가 가장 많은 사람: Person(name=철수, age=29) ← toString 자동 생성
```

리스트에서 가장 나이가 많은 사람을 찾기 위해 maxBy 함수를 사용한다. maxBy 함수에 전달한 람다 식은 파라미터를 하나 받는다. it이라는 이름을 사용하면 별도의 파라미터 이름을 정의하지 않아도) 람다 식의 유일한 인자를 사용할 수 있다. 엘비스 연산자(Elvis operator)라고 부르는 ?:는 age가 null인 경우 0을 반환하고, 그렇지 않은 경우 age의 값을 반환한다. 영희의 나이를 지정하지는 않았찌만 엘비스 연산자가 null을 0으로 변환해주기 때문에 철수가 가장 나이가 많은 사람으로 선정될 수 있다.



## 1.2 코틀린의 주요 특성

### 1.2.1 대상 플랫폼: 서버, 안드로이드 등 자바가 실행되는 모든 곳

__코틀린의 주목적__은 현재 자바가 사용되고 있는 모든 용도에 적합하면서도 더 간결하고 생산적이며 안전한 대체 언어를 제공하는 것

__코틀린을 할용할 수 있는 가장 일반적인 영역__

- 서버상의 코드(특히 웹 애플리케이션의 백엔드)
- 안드로이드 디바이스에서 실행되는 모바일 애플리케이션

그 외에도 iOS, 데스크탑 애플리케이션을 작성할 수 있고, 자바스크립트로도 코틀린을 컴파일할 수 있으므로 브라우저나 노드에서 실행할 수 있다.

### 1.2.2 정적 타입 지정 언어

자바와 마찬가지로 코틀린도 __정적 타입(statically typed) 지정 언어__다.

(정적 타입 지정: 모든 프로그램 구성 요소의 타입을 컴파일 시점에 알 수 있고 프로그램 안에서 객체의 필드나 메소드를 사용할 때마다 컴파일러가 타입을 검증해준다는 뜻)

__동적 타입(dynamically type) 지정 언어와 다른 점__

JVM에서는 그루비나 JRuby가 대표적인 동적 타입 지정언어다. 동적 타입 지정 언어에는 타입과 관계없이 모든 값을 변수에 넣을 수 있고, 메소드나 필드 접근에 대한 검증이 실행 시점에 일어나며, 그에 따라 코드가 더 짧아지고 데이터 구조를 더 유연하게 생성하고 사용할 수 있다. 하지만 반대로 이름을 잘못 입력하는 등의 실수도 컴파일 시 걸러내지 못하고 실행 시점에 오류가 발생한다.

자바와 달리 코틀린에서는 대부분의 경우 컴파일러가 문맥으로부터 변수 타입을 자동으로 유추할 수 있기 때문에 프로그래머는 __타입 선언을 생략해도 된다.__

컴파일러가 문맥을 고려해 변수 타입을 결정하는 이런 기능을 __타입 추론__이라고 부른다.

__정적 타입 지정의 장점__

- __성능__: 실행 시점에 어떤 메소드를 호출할지 알아내는 과정이 필요 없으므로 메소드 호출이 더 빠르다.
- __신뢰성__: 컴파일러가 프로그램의 정확성을 검증하기 때문에 실행 시 프로그램이 오류로 중단될 가능성이 더 적어진다.

- __유지 보수성__: 코드에서 다루는 객체가 어떤 타입에 속하는지 알 수 있기 때문에 처음 보는 코드를 다룰 때도 더 쉽다.
- __도구 지원__: 정적 타입 지정을 활용하면 더 안전하게 리팩토링 할 수 있고, 도구는 더 정확한 코드 완성 기능을 제공할 수 있으며, IDE의 다른 지원 기능도 더 잘 만들 수 있다.

__타입 시스템에서 자바와 다른 새로운 점__

- 널이 될 수 있는 타입(nullable type) 지원

컴파일 시점에 널 포인터 예외가 발생할 수 있는지 여부를 검사할 수 있어 좀 더 프로그램의 신뢰성을 높일 수 있다.

- 함수 타입에 대한 지원

### 1.2.3 함수형 프로그래밍과 객체지향 프로그래밍

__함수형 프로그래밍의 핵심 개념__

- __일급 시민인(first-class) 함수__: 함수를 일반 값처럼 다룰 수 있다. 함수를 변수에 지정할 수 있고, 함수를 인자로 다른 함수에 전달할 수 있으며, 함수에서 새로운 함수를 만들어서 반환할 수 있다.

- __불변성(immutability)__: 함수형 프로그래밍에서는 일단 만들어지고 나면 내부 상태가 절대로 바뀌지 않는 불변 객체를 사용해 프로그램을 작성한다.

- __부수 효과(side effect) 없음__: 함수형 프로그래밍에서는 입력이 같으면 항상 같은 출력을 내놓고 다른 객체의 상태를 변경하지 않으며, 함수 외부나 다른 바깥 환경과 상호작용하지 않는 순수 함수를 사용한다.

**함수형 스타일 프로그램 작성의 유익**

1. **간결성**

함수형 코드는 명령형 코드에 비해 더 간결하고 우아하다. 함수를 값처럼 사용할 수 있으며 더 강력한 추상화를 할 수 있고 강력한 추상화를 사용해 코드 중복을 막을 수 있다.

비슷한 작업을 수행하는 아주 비슷한 두 개의 코드 조각이 있을 때, 이 로직에서 공통부분을 따로 함수로 뽑아내고 서로 다른 세부 사항을 인자로 전달할 수 있다. 이런 인자는 그 자체가 함수다. 하지만 람다 식이라 불리는 무명 함수 구문을 사용하면 간결하게 그런 함수를 표현할 수 있다.

```kotlin
fun findAlice() = findPerson { it.name == "Alice" }	// findPerson에는 사람을 찾는 일반 로직이 들어가 있다.
fun findBob() = findPerson { it.name == "Bob" }	// 중괄호({}) 사이에 있는 코드 블록은 찾으려는 사람을 식별한다.
```

2. **다중 스레드를 사용해도 안전하다 (safe multithreading)**

다중 스레드 프로그램에서는 적절한 동기화 없이 같은 데이터를 여러 스레드가 변경하는 경우 가장 많은 문제가 생긴다. 불변 데이터 구조를 사용하고 순수 함수를 그 데이터 구조에 적용한다면 다중 스레드 환경에서 같은 데이터를 여러 스레드가 변경할 수 없다. 따라서 복잡한 동기화를 적용하지 않아도 된다.

3. **테스트하기 쉽다**

부수 효과가 있는 함수는 그 함수를 실행할 때 필요한 전체 환경을 구성하는 준비 코드가 따로 필요하지만, 순수 함수는 그런 준비 코드 없이 독립적으로 테스트할 수 있다.

**코틀린이 지원하는 함수형 프로그래밍**

- 함수 타입을 지원함에 따라 어떤 함수가 다른 함수를 파라미터로 받거나 함수가 새로운 함수를 반환할 수 있다.
- 람다 식을 지원함에 따라 번거로운 준비 코드를 작성하지 않아도 코드 블록을 쉽게 정의하고 여기저기 전달할 수 있다.
- 데이터 클래스는 불변적인 값 객체를 간편하게 만들 수 있는 구문을 제공한다.
- 코틀린 표준 라이브러리는 객체와 컬렉션을 함수형 스타일로 다룰 수 있는 API를 제공한다.

### 1.2.4 무료 오픈소스

- 코틀린 언어와 컴파일러, 라이브러리 및 코틀린과 관련된 모든 도구는 모두 오픈소스이다.
- 어떤 목적에든 무료로 사용할 수 있다.
- 개발은 깃허브를 통해 이루어지고 있다.
- 코틀린 애플리케이션을 개발하고 싶은 경우 인텔리J 아이디어 커뮤니티 에디션, 안드로이드 스튜디오, 이클립스 같은 오픈소스 IDE를 활용할 수 있다.
